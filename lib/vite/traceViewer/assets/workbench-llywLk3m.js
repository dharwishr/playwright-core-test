import{r as d,j as e,L as Mt,k as Vt,l as _t,n as kt,m as D,P as J,f as K,C as Gt,o as Yt,u as ht,p as St,G as qt,q as Kt,v as Jt,w as Qt,x as Zt,h as jt,y as te,z as ee,A as se,N as ie,S as wt,B as ne,D as Nt,T as bt,I as ae,E as re}from"./inspectorTab-D3V7WVTZ.js";const ce=Mt;function le({name:t,rootItem:s,render:i,icon:n,isError:r,isVisible:c,selectedItem:l,onAccepted:a,onSelected:h,onHighlighted:m,treeState:o,setTreeState:f,noItemsMessage:x,dataTestId:N,autoExpandDepth:j}){const w=d.useMemo(()=>oe(s,l,o.expandedItems,j||0),[s,l,o,j]),L=d.useMemo(()=>{if(!c)return[...w.keys()];const v=new Map,b=y=>{const M=v.get(y);if(M!==void 0)return M;let I=y.children.some(W=>b(W));for(const W of y.children){const P=b(W);I=I||P}const z=c(y)||I;return v.set(y,z),z};for(const y of w.keys())b(y);const T=[];for(const y of w.keys())c(y)&&T.push(y);return T},[w,c]);return e.jsx(ce,{name:t,items:L,id:v=>v.id,dataTestId:N||t+"-tree",render:v=>{const b=i(v);return e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"codicon "+(n(v)||"blank"),style:{minWidth:16,marginRight:4}}),typeof b=="string"?e.jsx("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:b}):b]})},icon:v=>{const b=w.get(v).expanded;if(typeof b=="boolean")return b?"codicon-chevron-down":"codicon-chevron-right"},isError:v=>(r==null?void 0:r(v))||!1,indent:v=>w.get(v).depth,selectedItem:l,onAccepted:v=>a==null?void 0:a(v),onSelected:v=>h==null?void 0:h(v),onHighlighted:v=>m==null?void 0:m(v),onLeftArrow:v=>{const{expanded:b,parent:T}=w.get(v);b?(o.expandedItems.set(v.id,!1),f({...o})):T&&(h==null||h(T))},onRightArrow:v=>{v.children.length&&(o.expandedItems.set(v.id,!0),f({...o}))},onIconClicked:v=>{const{expanded:b}=w.get(v);if(b){for(let T=l;T;T=T.parent)if(T===v){h==null||h(v);break}o.expandedItems.set(v.id,!1)}else o.expandedItems.set(v.id,!0);f({...o})},noItemsMessage:x})}function oe(t,s,i,n){const r=new Map,c=new Set;for(let a=s==null?void 0:s.parent;a;a=a.parent)c.add(a.id);const l=(a,h)=>{for(const m of a.children){const o=c.has(m.id)||i.get(m.id),f=n>h&&r.size<25&&o!==!1,x=m.children.length?o??f:void 0;r.set(m,{depth:h,expanded:x,parent:t===a?null:a}),x&&l(m,h+1)}};return l(t,0),r}const he=le,de=({actions:t,selectedAction:s,selectedTime:i,setSelectedTime:n,sdkLanguage:r,onSelected:c,onHighlighted:l,revealConsole:a,isLive:h})=>{const[m,o]=d.useState({expandedItems:new Map}),{rootItem:f,itemMap:x}=d.useMemo(()=>Vt(t),[t]),{selectedItem:N}=d.useMemo(()=>({selectedItem:s?x.get(s.callId):void 0}),[x,s]);return e.jsxs("div",{className:"vbox",children:[i&&e.jsxs("div",{className:"action-list-show-all",onClick:()=>n(void 0),children:[e.jsx("span",{className:"codicon codicon-triangle-left"}),"Show all"]}),e.jsx(he,{name:"actions",rootItem:f,treeState:m,setTreeState:o,selectedItem:N,onSelected:j=>c==null?void 0:c(j.action),onHighlighted:j=>l==null?void 0:l(j==null?void 0:j.action),onAccepted:j=>n({minimum:j.action.startTime,maximum:j.action.endTime}),isError:j=>{var w,L;return!!((L=(w=j.action)==null?void 0:w.error)!=null&&L.message)},isVisible:j=>!i||j.action.startTime<=i.maximum&&j.action.endTime>=i.minimum,render:j=>dt(j.action,{sdkLanguage:r,revealConsole:a,isLive:h,showDuration:!0,showBadges:!0})})]})},dt=(t,s)=>{const{sdkLanguage:i,revealConsole:n,isLive:r,showDuration:c,showBadges:l}=s,{errors:a,warnings:h}=_t(t),m=t.params.selector?kt(i||"javascript",t.params.selector):void 0;let o="";return t.endTime?o=D(t.endTime-t.startTime):t.error?o="Timed out":r||(o="-"),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"action-title",title:t.apiName,children:[e.jsx("span",{children:t.apiName}),m&&e.jsx("div",{className:"action-selector",title:m,children:m}),t.method==="goto"&&t.params.url&&e.jsx("div",{className:"action-url",title:t.params.url,children:t.params.url}),t.class==="APIRequestContext"&&t.params.url&&e.jsx("div",{className:"action-url",title:t.params.url,children:me(t.params.url)})]}),(c||l)&&e.jsx("div",{className:"spacer"}),c&&e.jsx("div",{className:"action-duration",children:o||e.jsx("span",{className:"codicon codicon-loading"})}),l&&e.jsxs("div",{className:"action-icons",onClick:()=>n==null?void 0:n(),children:[!!a&&e.jsxs("div",{className:"action-icon",children:[e.jsx("span",{className:"codicon codicon-error"}),e.jsx("span",{className:"action-icon-value",children:a})]}),!!h&&e.jsxs("div",{className:"action-icon",children:[e.jsx("span",{className:"codicon codicon-warning"}),e.jsx("span",{className:"action-icon-value",children:h})]})]})]})};function me(t){try{const s=new URL(t);return s.pathname+s.search}catch{return t}}const ue=({action:t,sdkLanguage:s})=>{if(!t)return e.jsx(J,{text:"No action selected"});const i={...t.params};delete i.info;const n=Object.keys(i),r=t.startTime+(t.context.wallTime-t.context.startTime),c=new Date(r).toLocaleString(),l=t.endTime?D(t.endTime-t.startTime):"Timed Out";return e.jsxs("div",{className:"call-tab",children:[e.jsx("div",{className:"call-line",children:t.apiName}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"call-section",children:"Time"}),c&&e.jsxs("div",{className:"call-line",children:["wall time:",e.jsx("span",{className:"call-value datetime",title:c,children:c})]}),e.jsxs("div",{className:"call-line",children:["duration:",e.jsx("span",{className:"call-value datetime",title:l,children:l})]})]}),!!n.length&&e.jsx("div",{className:"call-section",children:"Parameters"}),!!n.length&&n.map((a,h)=>yt(Tt(t,a,i[a],s),"param-"+h)),!!t.result&&e.jsx("div",{className:"call-section",children:"Return value"}),!!t.result&&Object.keys(t.result).map((a,h)=>yt(Tt(t,a,t.result[a],s),"result-"+h))]})};function yt(t,s){let i=t.text.replace(/\n/g,"â†µ");return t.type==="string"&&(i=`"${i}"`),e.jsxs("div",{className:"call-line",children:[t.name,":",e.jsx("span",{className:K("call-value",t.type),title:t.text,children:i}),["string","number","object","locator"].includes(t.type)&&e.jsx(Gt,{value:t.text})]},s)}function Tt(t,s,i,n){const r=t.method.includes("eval")||t.method==="waitForFunction";if(s==="files")return{text:"<files>",type:"string",name:s};if((s==="eventInit"||s==="expectedValue"||s==="arg"&&r)&&(i=et(i.value,new Array(10).fill({handle:"<handle>"}))),(s==="value"&&r||s==="received"&&t.method==="expect")&&(i=et(i,new Array(10).fill({handle:"<handle>"}))),s==="selector")return{text:kt(n||"javascript",t.params.selector),type:"locator",name:"locator"};const c=typeof i;return c!=="object"||i===null?{text:String(i),type:c,name:s}:i.guid?{text:"<handle>",type:"handle",name:s}:{text:JSON.stringify(i).slice(0,1e3),type:"object",name:s}}function et(t,s){if(t.n!==void 0)return t.n;if(t.s!==void 0)return t.s;if(t.b!==void 0)return t.b;if(t.v!==void 0){if(t.v==="undefined")return;if(t.v==="null")return null;if(t.v==="NaN")return NaN;if(t.v==="Infinity")return 1/0;if(t.v==="-Infinity")return-1/0;if(t.v==="-0")return-0}if(t.d!==void 0)return new Date(t.d);if(t.r!==void 0)return new RegExp(t.r.p,t.r.f);if(t.a!==void 0)return t.a.map(i=>et(i,s));if(t.o!==void 0){const i={};for(const{k:n,v:r}of t.o)i[n]=et(r,s);return i}return t.h!==void 0?s===void 0?"<object>":s[t.h]:"<object>"}const xe=Mt,fe=({action:t,isLive:s})=>{const i=d.useMemo(()=>{var l;if(!t||!t.log.length)return[];const n=t.log,r=t.context.wallTime-t.context.startTime,c=[];for(let a=0;a<n.length;++a){let h="";if(n[a].time!==-1){const m=(l=n[a])==null?void 0:l.time;a+1<n.length?h=D(n[a+1].time-m):t.endTime>0?h=D(t.endTime-m):s?h=D(Date.now()-r-m):h="-"}c.push({message:n[a].message,time:h})}return c},[t,s]);return i.length?e.jsx(xe,{name:"log",items:i,render:n=>e.jsxs("div",{className:"log-list-item",children:[e.jsx("span",{className:"log-list-duration",children:n.time}),n.message]}),notSelectable:!0}):e.jsx(J,{text:"No log entries"})},pe=({error:t})=>{const s=d.useMemo(()=>Yt(t),[t]);return e.jsx("div",{className:"error-message",dangerouslySetInnerHTML:{__html:s||""}})};function ge(t){return d.useMemo(()=>{if(!t)return{errors:new Map};const s=new Map;for(const i of t.errorDescriptors)s.set(i.message,i);return{errors:s}},[t])}const ve=({errorsModel:t,sdkLanguage:s,revealInSource:i})=>t.errors.size?e.jsx("div",{className:"fill",style:{overflow:"auto"},children:[...t.errors.entries()].map(([n,r])=>{var h;let c,l;const a=(h=r.stack)==null?void 0:h[0];return a&&(c=a.file.replace(/.*[/\\](.*)/,"$1")+":"+a.line,l=a.file+":"+a.line),e.jsxs("div",{children:[e.jsxs("div",{className:"hbox",style:{alignItems:"center",padding:"5px 10px",minHeight:36,fontWeight:"bold",color:"var(--vscode-errorForeground)"},children:[r.action&&dt(r.action,{sdkLanguage:s}),c&&e.jsxs("div",{className:"action-location",children:["@ ",e.jsx("span",{title:l,onClick:()=>i(r),children:c})]})]}),e.jsx(pe,{error:n})]},n)})}):e.jsx(J,{text:"No errors"}),Ct={width:200,height:45},G=2.5,je=Ct.height+G*2,we=({model:t,boundaries:s,previewPoint:i})=>{var o,f;const[n,r]=ht(),c=d.useRef(null);let l=0;if(c.current&&i){const x=c.current.getBoundingClientRect();l=(i.clientY-x.top+c.current.scrollTop)/je|0}const a=(f=(o=t==null?void 0:t.pages)==null?void 0:o[l])==null?void 0:f.screencastFrames;let h,m;if(i!==void 0&&a&&a.length){const x=s.minimum+(s.maximum-s.minimum)*i.x/n.width;h=a[St(a,x,Lt)-1];const N={width:Math.min(800,window.innerWidth/2|0),height:Math.min(800,window.innerHeight/2|0)};m=h?It({width:h.width,height:h.height},N):void 0}return e.jsxs("div",{className:"film-strip",ref:r,children:[e.jsx("div",{className:"film-strip-lanes",ref:c,children:t==null?void 0:t.pages.map((x,N)=>x.screencastFrames.length?e.jsx(Ne,{boundaries:s,page:x,width:n.width},N):null)}),(i==null?void 0:i.x)!==void 0&&e.jsxs("div",{className:"film-strip-hover",style:{top:n.bottom+5,left:Math.min(i.x,n.width-(m?m.width:0)-10)},children:[i.action&&e.jsx("div",{className:"film-strip-hover-title",children:dt(i.action,i)}),h&&m&&e.jsx("div",{style:{width:m.width,height:m.height},children:e.jsx("img",{src:`sha1/${h.sha1}`,width:m.width,height:m.height})})]})]})},Ne=({boundaries:t,page:s,width:i})=>{const n={width:0,height:0},r=s.screencastFrames;for(const w of r)n.width=Math.max(n.width,w.width),n.height=Math.max(n.height,w.height);const c=It(n,Ct),l=r[0].timestamp,a=r[r.length-1].timestamp,h=t.maximum-t.minimum,m=(l-t.minimum)/h*i,o=(t.maximum-a)/h*i,x=(a-l)/h*i/(c.width+2*G)|0,N=(a-l)/x,j=[];for(let w=0;l&&N&&w<x;++w){const L=l+N*w,v=St(r,L,Lt)-1;j.push(e.jsx("div",{className:"film-strip-frame",style:{width:c.width,height:c.height,backgroundImage:`url(sha1/${r[v].sha1})`,backgroundSize:`${c.width}px ${c.height}px`,margin:G,marginRight:G}},w))}return j.push(e.jsx("div",{className:"film-strip-frame",style:{width:c.width,height:c.height,backgroundImage:`url(sha1/${r[r.length-1].sha1})`,backgroundSize:`${c.width}px ${c.height}px`,margin:G,marginRight:G}},j.length)),e.jsx("div",{className:"film-strip-lane",style:{marginLeft:m+"px",marginRight:o+"px"},children:j})};function Lt(t,s){return t-s.timestamp}function It(t,s){const i=Math.max(t.width/s.width,t.height/s.height);return{width:t.width/i|0,height:t.height/i|0}}const be=({model:t,boundaries:s,consoleEntries:i,onSelected:n,highlightedAction:r,highlightedEntry:c,highlightedConsoleEntry:l,selectedTime:a,setSelectedTime:h,sdkLanguage:m})=>{const[o,f]=ht(),[x,N]=d.useState(),[j,w]=d.useState(),{offsets:L,curtainLeft:v,curtainRight:b}=d.useMemo(()=>{let p=a||s;if(x&&x.startX!==x.endX){const S=X(o.width,s,x.startX),R=X(o.width,s,x.endX);p={minimum:Math.min(S,R),maximum:Math.max(S,R)}}const u=H(o.width,s,p.minimum),C=H(o.width,s,s.maximum)-H(o.width,s,p.maximum);return{offsets:ye(o.width,s),curtainLeft:u,curtainRight:C}},[a,s,x,o]),T=d.useMemo(()=>{const p=[];for(const u of(t==null?void 0:t.actions)||[])u.class!=="Test"&&p.push({action:u,leftTime:u.startTime,rightTime:u.endTime||s.maximum,leftPosition:H(o.width,s,u.startTime),rightPosition:H(o.width,s,u.endTime||s.maximum),active:!1,error:!!u.error});for(const u of(t==null?void 0:t.resources)||[]){const k=u._monotonicTime,C=u._monotonicTime+u.time;p.push({resource:u,leftTime:k,rightTime:C,leftPosition:H(o.width,s,k),rightPosition:H(o.width,s,C),active:!1,error:!1})}for(const u of i||[])p.push({consoleMessage:u,leftTime:u.timestamp,rightTime:u.timestamp,leftPosition:H(o.width,s,u.timestamp),rightPosition:H(o.width,s,u.timestamp),active:!1,error:u.isError});return p},[t,i,s,o]);d.useMemo(()=>{for(const p of T)r?p.active=p.action===r:c?p.active=p.resource===c:l?p.active=p.consoleMessage===l:p.active=!1},[T,r,c,l]);const y=d.useCallback(p=>{if(w(void 0),!f.current)return;const u=p.clientX-f.current.getBoundingClientRect().left,k=X(o.width,s,u),C=a?H(o.width,s,a.minimum):0,S=a?H(o.width,s,a.maximum):0;a&&Math.abs(u-C)<10?N({startX:S,endX:u,type:"resize"}):a&&Math.abs(u-S)<10?N({startX:C,endX:u,type:"resize"}):a&&k>a.minimum&&k<a.maximum&&p.clientY-f.current.getBoundingClientRect().top<20?N({startX:C,endX:S,pivot:u,type:"move"}):N({startX:u,endX:u,type:"resize"})},[s,o,f,a]),M=d.useCallback(p=>{if(!f.current)return;const u=p.clientX-f.current.getBoundingClientRect().left,k=X(o.width,s,u),C=t==null?void 0:t.actions.findLast(A=>A.startTime<=k);if(!p.buttons){N(void 0);return}if(C&&n(C),!x)return;let S=x;if(x.type==="resize")S={...x,endX:u};else{const A=u-x.pivot;let B=x.startX+A,$=x.endX+A;B<0&&(B=0,$=B+(x.endX-x.startX)),$>o.width&&($=o.width,B=$-(x.endX-x.startX)),S={...x,startX:B,endX:$,pivot:u}}N(S);const R=X(o.width,s,S.startX),U=X(o.width,s,S.endX);R!==U&&h({minimum:Math.min(R,U),maximum:Math.max(R,U)})},[s,x,o,t,n,f,h]),I=d.useCallback(()=>{if(w(void 0),!!x){if(x.startX!==x.endX){const p=X(o.width,s,x.startX),u=X(o.width,s,x.endX);h({minimum:Math.min(p,u),maximum:Math.max(p,u)})}else{const p=X(o.width,s,x.startX),u=t==null?void 0:t.actions.findLast(k=>k.startTime<=p);u&&n(u),h(void 0)}N(void 0)}},[s,x,o,t,h,n]),z=d.useCallback(p=>{if(!f.current)return;const u=p.clientX-f.current.getBoundingClientRect().left,k=X(o.width,s,u),C=t==null?void 0:t.actions.findLast(S=>S.startTime<=k);w({x:u,clientY:p.clientY,action:C,sdkLanguage:m})},[s,o,t,f,m]),W=d.useCallback(()=>{w(void 0)},[]),P=d.useCallback(()=>{h(void 0)},[h]);return e.jsxs("div",{style:{flex:"none",borderBottom:"1px solid var(--vscode-panel-border)"},children:[!!x&&e.jsx(qt,{cursor:(x==null?void 0:x.type)==="resize"?"ew-resize":"grab",onPaneMouseUp:I,onPaneMouseMove:M,onPaneDoubleClick:P}),e.jsxs("div",{ref:f,className:"timeline-view",onMouseDown:y,onMouseMove:z,onMouseLeave:W,children:[e.jsx("div",{className:"timeline-grid",children:L.map((p,u)=>e.jsx("div",{className:"timeline-divider",style:{left:p.position+"px"},children:e.jsx("div",{className:"timeline-time",children:D(p.time-s.minimum)})},u))}),e.jsx("div",{style:{height:8}}),e.jsx(we,{model:t,boundaries:s,previewPoint:j}),e.jsx("div",{className:"timeline-bars",children:T.map((p,u)=>e.jsx("div",{className:K("timeline-bar",p.action&&"action",p.resource&&"network",p.consoleMessage&&"console-message",p.active&&"active",p.error&&"error"),style:{left:p.leftPosition,width:Math.max(5,p.rightPosition-p.leftPosition),top:Te(p),bottom:0}},u))}),e.jsx("div",{className:"timeline-marker",style:{display:j!==void 0?"block":"none",left:((j==null?void 0:j.x)||0)+"px"}}),a&&e.jsxs("div",{className:"timeline-window",children:[e.jsx("div",{className:"timeline-window-curtain left",style:{width:v}}),e.jsx("div",{className:"timeline-window-resizer",style:{left:-5}}),e.jsx("div",{className:"timeline-window-center",children:e.jsx("div",{className:"timeline-window-drag"})}),e.jsx("div",{className:"timeline-window-resizer",style:{left:5}}),e.jsx("div",{className:"timeline-window-curtain right",style:{width:b}})]})]})]})};function ye(t,s){let n=t/64;const r=s.maximum-s.minimum,c=t/r;let l=r/n;const a=Math.ceil(Math.log(l)/Math.LN10);l=Math.pow(10,a),l*c>=5*64&&(l=l/5),l*c>=2*64&&(l=l/2);const h=s.minimum;let m=s.maximum;m+=64/c,n=Math.ceil((m-h)/l),l||(n=0);const o=[];for(let f=0;f<n;++f){const x=h+l*f;o.push({position:H(t,s,x),time:x})}return o}function H(t,s,i){return(i-s.minimum)/(s.maximum-s.minimum)*t}function X(t,s,i){return i/t*(s.maximum-s.minimum)+s.minimum}function Te(t){return t.resource?25:20}const Me=({model:t})=>{var s,i;return t?e.jsxs("div",{"data-testid":"metadata-view",className:"vbox",style:{flexShrink:0},children:[e.jsx("div",{className:"call-section",style:{paddingTop:2},children:"Time"}),!!t.wallTime&&e.jsxs("div",{className:"call-line",children:["start time:",e.jsx("span",{className:"call-value datetime",title:new Date(t.wallTime).toLocaleString(),children:new Date(t.wallTime).toLocaleString()})]}),e.jsxs("div",{className:"call-line",children:["duration:",e.jsx("span",{className:"call-value number",title:D(t.endTime-t.startTime),children:D(t.endTime-t.startTime)})]}),e.jsx("div",{className:"call-section",children:"Browser"}),e.jsxs("div",{className:"call-line",children:["engine:",e.jsx("span",{className:"call-value string",title:t.browserName,children:t.browserName})]}),t.channel&&e.jsxs("div",{className:"call-line",children:["channel:",e.jsx("span",{className:"call-value string",title:t.channel,children:t.channel})]}),t.platform&&e.jsxs("div",{className:"call-line",children:["platform:",e.jsx("span",{className:"call-value string",title:t.platform,children:t.platform})]}),t.options.userAgent&&e.jsxs("div",{className:"call-line",children:["user agent:",e.jsx("span",{className:"call-value datetime",title:t.options.userAgent,children:t.options.userAgent})]}),t.options.baseURL&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"call-section",style:{paddingTop:2},children:"Config"}),e.jsxs("div",{className:"call-line",children:["baseURL:",e.jsx("a",{className:"call-value string",href:t.options.baseURL,title:t.options.baseURL,target:"_blank",rel:"noopener noreferrer",children:t.options.baseURL})]})]}),e.jsx("div",{className:"call-section",children:"Viewport"}),t.options.viewport&&e.jsxs("div",{className:"call-line",children:["width:",e.jsx("span",{className:"call-value number",title:String(!!((s=t.options.viewport)!=null&&s.width)),children:t.options.viewport.width})]}),t.options.viewport&&e.jsxs("div",{className:"call-line",children:["height:",e.jsx("span",{className:"call-value number",title:String(!!((i=t.options.viewport)!=null&&i.height)),children:t.options.viewport.height})]}),e.jsxs("div",{className:"call-line",children:["is mobile:",e.jsx("span",{className:"call-value boolean",title:String(!!t.options.isMobile),children:String(!!t.options.isMobile)})]}),t.options.deviceScaleFactor&&e.jsxs("div",{className:"call-line",children:["device scale:",e.jsx("span",{className:"call-value number",title:String(t.options.deviceScaleFactor),children:String(t.options.deviceScaleFactor)})]}),e.jsx("div",{className:"call-section",children:"Counts"}),e.jsxs("div",{className:"call-line",children:["pages:",e.jsx("span",{className:"call-value number",children:t.pages.length})]}),e.jsxs("div",{className:"call-line",children:["actions:",e.jsx("span",{className:"call-value number",children:t.actions.length})]}),e.jsxs("div",{className:"call-line",children:["events:",e.jsx("span",{className:"call-value number",children:t.events.length})]})]}):e.jsx(e.Fragment,{})};async function lt(t){const s=new Image;return t&&(s.src=t,await new Promise((i,n)=>{s.onload=i,s.onerror=i})),s}const ot={backgroundImage:`linear-gradient(45deg, #80808020 25%, transparent 25%),
                    linear-gradient(-45deg, #80808020 25%, transparent 25%),
                    linear-gradient(45deg, transparent 75%, #80808020 75%),
                    linear-gradient(-45deg, transparent 75%, #80808020 75%)`,backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",boxShadow:`rgb(0 0 0 / 10%) 0px 1.8px 1.9px,
              rgb(0 0 0 / 15%) 0px 6.1px 6.3px,
              rgb(0 0 0 / 10%) 0px -2px 4px,
              rgb(0 0 0 / 15%) 0px -6.1px 12px,
              rgb(0 0 0 / 25%) 0px 6px 12px`},ke=({diff:t,noTargetBlank:s,hideDetails:i})=>{const[n,r]=d.useState(t.diff?"diff":"actual"),[c,l]=d.useState(!1),[a,h]=d.useState(null),[m,o]=d.useState("Expected"),[f,x]=d.useState(null),[N,j]=d.useState(null),[w,L]=ht();d.useEffect(()=>{(async()=>{var P,p,u,k;h(await lt((P=t.expected)==null?void 0:P.attachment.path)),o(((p=t.expected)==null?void 0:p.title)||"Expected"),x(await lt((u=t.actual)==null?void 0:u.attachment.path)),j(await lt((k=t.diff)==null?void 0:k.attachment.path))})()},[t]);const v=a&&f&&N,b=v?Math.max(a.naturalWidth,f.naturalWidth,200):500,T=v?Math.max(a.naturalHeight,f.naturalHeight,200):500,y=Math.min(1,(w.width-30)/b),M=Math.min(1,(w.width-50)/b/2),I=b*y,z=T*y,W={flex:"none",margin:"0 10px",cursor:"pointer",userSelect:"none"};return e.jsx("div",{"data-testid":"test-result-image-mismatch",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:"auto"},ref:L,children:v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-testid":"test-result-image-mismatch-tabs",style:{display:"flex",margin:"10px 0 20px"},children:[t.diff&&e.jsx("div",{style:{...W,fontWeight:n==="diff"?600:"initial"},onClick:()=>r("diff"),children:"Diff"}),e.jsx("div",{style:{...W,fontWeight:n==="actual"?600:"initial"},onClick:()=>r("actual"),children:"Actual"}),e.jsx("div",{style:{...W,fontWeight:n==="expected"?600:"initial"},onClick:()=>r("expected"),children:m}),e.jsx("div",{style:{...W,fontWeight:n==="sxs"?600:"initial"},onClick:()=>r("sxs"),children:"Side by side"}),e.jsx("div",{style:{...W,fontWeight:n==="slider"?600:"initial"},onClick:()=>r("slider"),children:"Slider"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",flex:"auto",minHeight:z+60},children:[t.diff&&n==="diff"&&e.jsx(F,{image:N,alt:"Diff",hideSize:i,canvasWidth:I,canvasHeight:z,scale:y}),t.diff&&n==="actual"&&e.jsx(F,{image:f,alt:"Actual",hideSize:i,canvasWidth:I,canvasHeight:z,scale:y}),t.diff&&n==="expected"&&e.jsx(F,{image:a,alt:m,hideSize:i,canvasWidth:I,canvasHeight:z,scale:y}),t.diff&&n==="slider"&&e.jsx(Se,{expectedImage:a,actualImage:f,hideSize:i,canvasWidth:I,canvasHeight:z,scale:y,expectedTitle:m}),t.diff&&n==="sxs"&&e.jsxs("div",{style:{display:"flex"},children:[e.jsx(F,{image:a,title:m,hideSize:i,canvasWidth:M*b,canvasHeight:M*T,scale:M}),e.jsx(F,{image:c?N:f,title:c?"Diff":"Actual",onClick:()=>l(!c),hideSize:i,canvasWidth:M*b,canvasHeight:M*T,scale:M})]}),!t.diff&&n==="actual"&&e.jsx(F,{image:f,title:"Actual",hideSize:i,canvasWidth:I,canvasHeight:z,scale:y}),!t.diff&&n==="expected"&&e.jsx(F,{image:a,title:m,hideSize:i,canvasWidth:I,canvasHeight:z,scale:y}),!t.diff&&n==="sxs"&&e.jsxs("div",{style:{display:"flex"},children:[e.jsx(F,{image:a,title:m,canvasWidth:M*b,canvasHeight:M*T,scale:M}),e.jsx(F,{image:f,title:"Actual",canvasWidth:M*b,canvasHeight:M*T,scale:M})]})]}),!i&&e.jsxs("div",{style:{alignSelf:"start",lineHeight:"18px",marginLeft:"15px"},children:[e.jsx("div",{children:t.diff&&e.jsx("a",{target:"_blank",href:t.diff.attachment.path,rel:"noreferrer",children:t.diff.attachment.name})}),e.jsx("div",{children:e.jsx("a",{target:s?"":"_blank",href:t.actual.attachment.path,rel:"noreferrer",children:t.actual.attachment.name})}),e.jsx("div",{children:e.jsx("a",{target:s?"":"_blank",href:t.expected.attachment.path,rel:"noreferrer",children:t.expected.attachment.name})})]})]})})},Se=({expectedImage:t,actualImage:s,canvasWidth:i,canvasHeight:n,scale:r,expectedTitle:c,hideSize:l})=>{const a={position:"absolute",top:0,left:0},[h,m]=d.useState(i/2),o=t.naturalWidth===s.naturalWidth&&t.naturalHeight===s.naturalHeight;return e.jsxs("div",{style:{flex:"none",display:"flex",alignItems:"center",flexDirection:"column",userSelect:"none"},children:[!l&&e.jsxs("div",{style:{margin:5},children:[!o&&e.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"Expected "}),e.jsx("span",{children:t.naturalWidth}),e.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),e.jsx("span",{children:t.naturalHeight}),!o&&e.jsx("span",{style:{flex:"none",margin:"0 5px 0 15px"},children:"Actual "}),!o&&e.jsx("span",{children:s.naturalWidth}),!o&&e.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),!o&&e.jsx("span",{children:s.naturalHeight})]}),e.jsxs("div",{style:{position:"relative",width:i,height:n,margin:15,...ot},children:[e.jsx(Kt,{orientation:"horizontal",offsets:[h],setOffsets:f=>m(f[0]),resizerColor:"#57606a80",resizerWidth:6}),e.jsx("img",{alt:c,style:{width:t.naturalWidth*r,height:t.naturalHeight*r},draggable:"false",src:t.src}),e.jsx("div",{style:{...a,bottom:0,overflow:"hidden",width:h,...ot},children:e.jsx("img",{alt:"Actual",style:{width:s.naturalWidth*r,height:s.naturalHeight*r},draggable:"false",src:s.src})})]})]})},F=({image:t,title:s,alt:i,hideSize:n,canvasWidth:r,canvasHeight:c,scale:l,onClick:a})=>e.jsxs("div",{style:{flex:"none",display:"flex",alignItems:"center",flexDirection:"column"},children:[!n&&e.jsxs("div",{style:{margin:5},children:[s&&e.jsx("span",{style:{flex:"none",margin:"0 5px"},children:s}),e.jsx("span",{children:t.naturalWidth}),e.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),e.jsx("span",{children:t.naturalHeight})]}),e.jsx("div",{style:{display:"flex",flex:"none",width:r,height:c,margin:15,...ot},children:e.jsx("img",{width:t.naturalWidth*l,height:t.naturalHeight*l,alt:s||i,style:{cursor:a?"pointer":"initial"},draggable:"false",src:t.src,onClick:a})})]});function Ce(t){return!!t.match(/^(text\/.*?|application\/(json|(x-)?javascript|xml.*?|ecmascript|graphql|x-www-form-urlencoded)|image\/svg(\+xml)?|application\/.*?(\+json|\+xml))(;\s*charset=.*)?$/)}const Le=({title:t,children:s,setExpanded:i,expanded:n,expandOnTitleClick:r})=>e.jsxs("div",{className:K("expandable",n&&"expanded"),children:[e.jsxs("div",{className:"expandable-title",onClick:()=>r&&i(!n),children:[e.jsx("div",{className:K("codicon",n?"codicon-chevron-down":"codicon-chevron-right"),style:{cursor:"pointer",color:"var(--vscode-foreground)",marginLeft:"5px"},onClick:()=>!r&&i(!n)}),t]}),n&&e.jsx("div",{style:{marginLeft:25},children:s})]});function zt(t){const s=[];let i=0,n;for(;(n=Jt.exec(t))!==null;){const c=t.substring(i,n.index);c&&s.push(c);const l=n[0];s.push(Ie(l)),i=n.index+l.length}const r=t.substring(i);return r&&s.push(r),s}function Ie(t){let s=t;return s.startsWith("www.")&&(s="https://"+s),e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:t})}const ze=({attachment:t})=>{const[s,i]=d.useState(!1),[n,r]=d.useState(null),[c,l]=d.useState(null),a=Ce(t.contentType),h=!!t.sha1||!!t.path;d.useEffect(()=>{s&&n===null&&c===null&&(l("Loading ..."),fetch(mt(t)).then(f=>f.text()).then(f=>{r(f),l(null)}).catch(f=>{l("Failed to load: "+f.message)}))},[s,n,c,t]);const m=d.useMemo(()=>{const f=n?n.split(`
`).length:0;return Math.min(Math.max(5,f),20)*Qt},[n]),o=e.jsxs("span",{style:{marginLeft:5},children:[zt(t.name)," ",h&&e.jsx("a",{style:{marginLeft:5},href:tt(t),children:"download"})]});return!a||!h?e.jsx("div",{style:{marginLeft:20},children:o}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{title:o,expanded:s,setExpanded:i,expandOnTitleClick:!0,children:c&&e.jsx("i",{children:c})}),s&&n!==null&&e.jsx("div",{className:"vbox",style:{height:m},children:e.jsx(Zt,{text:n,readOnly:!0,mimeType:t.contentType,linkify:!0,lineNumbers:!0,wrapLines:!1})})]})},We=({model:t})=>{const{diffMap:s,screenshots:i,attachments:n}=d.useMemo(()=>{const r=new Set,c=new Set;for(const a of(t==null?void 0:t.actions)||[]){const h=a.context.traceUrl;for(const m of a.attachments||[])r.add({...m,traceUrl:h})}const l=new Map;for(const a of r){if(!a.path&&!a.sha1)continue;const h=a.name.match(/^(.*)-(expected|actual|diff)\.png$/);if(h){const m=h[1],o=h[2],f=l.get(m)||{expected:void 0,actual:void 0,diff:void 0};f[o]=a,l.set(m,f),r.delete(a)}else a.contentType.startsWith("image/")&&(c.add(a),r.delete(a))}return{diffMap:l,attachments:r,screenshots:c}},[t]);return!s.size&&!i.size&&!n.size?e.jsx(J,{text:"No attachments"}):e.jsxs("div",{className:"attachments-tab",children:[[...s.values()].map(({expected:r,actual:c,diff:l})=>e.jsxs(e.Fragment,{children:[r&&c&&e.jsx("div",{className:"attachments-section",children:"Image diff"}),r&&c&&e.jsx(ke,{noTargetBlank:!0,diff:{name:"Image diff",expected:{attachment:{...r,path:tt(r)},title:"Expected"},actual:{attachment:{...c,path:tt(c)}},diff:l?{attachment:{...l,path:tt(l)}}:void 0}})]})),i.size?e.jsx("div",{className:"attachments-section",children:"Screenshots"}):void 0,[...i.values()].map((r,c)=>{const l=mt(r);return e.jsxs("div",{className:"attachment-item",children:[e.jsx("div",{children:e.jsx("img",{draggable:"false",src:l})}),e.jsx("div",{children:e.jsx("a",{target:"_blank",href:l,rel:"noreferrer",children:r.name})})]},`screenshot-${c}`)}),n.size?e.jsx("div",{className:"attachments-section",children:"Attachments"}):void 0,[...n.values()].map((r,c)=>e.jsx("div",{className:"attachment-item",children:e.jsx(ze,{attachment:r})},Re(r,c)))]})};function mt(t,s={}){const i=new URLSearchParams(s);return t.sha1?(i.set("trace",t.traceUrl),"sha1/"+t.sha1+"?"+i.toString()):(i.set("path",t.path),"file?"+i.toString())}function tt(t){const s={dn:t.name};return t.contentType&&(s.dct=t.contentType),mt(t,s)}function Re(t,s){return s+"-"+(t.sha1?"sha1-"+t.sha1:"path-"+t.path)}const He=({annotations:t})=>t.length?e.jsx("div",{className:"annotations-tab",children:t.map((s,i)=>e.jsxs("div",{className:"annotation-item",children:[e.jsx("span",{style:{fontWeight:"bold"},children:s.type}),s.description&&e.jsxs("span",{children:[": ",zt(s.description)]})]},`annotation-${i}`))}):e.jsx(J,{text:"No annotations"});function Xe(t){return t==="scheduled"?"codicon-clock":t==="running"?"codicon-loading":t==="failed"?"codicon-error":t==="passed"?"codicon-check":t==="skipped"?"codicon-circle-slash":"codicon-circle-outline"}function Ae(t){return t==="scheduled"?"Pending":t==="running"?"Running":t==="failed"?"Failed":t==="passed"?"Passed":t==="skipped"?"Skipped":"Did not run"}const Fe=({model:t,showSourcesFirst:s,rootDir:i,fallbackLocation:n,isLive:r,hideTimeline:c,status:l,annotations:a,inert:h,openPage:m,onOpenExternally:o,revealSource:f,showSettings:x})=>{var vt;const[N,j]=d.useState(void 0),[w,L]=d.useState(void 0),[v,b]=d.useState(),[T,y]=d.useState(),[M,I]=d.useState(),[z,W]=d.useState("actions"),[P,p]=jt("propertiesTab",s?"source":"call"),[u,k]=d.useState(!1),[C,S]=d.useState(""),[R,U]=d.useState(),[A,B]=jt("propertiesSidebarLocation","bottom"),$=!1,st=d.useCallback(g=>{j(g==null?void 0:g.callId),L(void 0)},[]),it=d.useMemo(()=>t==null?void 0:t.actions.find(g=>g.callId===v),[t,v]),nt=d.useCallback(g=>{b(g==null?void 0:g.callId)},[]),Wt=d.useMemo(()=>(t==null?void 0:t.sources)||new Map,[t]);d.useEffect(()=>{U(void 0),L(void 0)},[t]);const Q=d.useMemo(()=>{if(N){const q=t==null?void 0:t.actions.find(V=>V.callId===N);if(q)return q}const g=t==null?void 0:t.failedAction();if(g)return g;if(t!=null&&t.actions.length){let q=t.actions.length-1;for(let V=0;V<t.actions.length;++V)if(t.actions[V].apiName==="After Hooks"&&V){q=V-1;break}return t.actions[q]}},[t,N]),O=d.useMemo(()=>it||Q,[Q,it]),Rt=d.useMemo(()=>w?w.stack:O==null?void 0:O.stack,[O,w]),ut=d.useCallback(g=>{st(g),nt(void 0)},[st,nt]),E=d.useCallback(g=>{p(g),g!=="inspector"&&k(!1)},[p]),xt=d.useCallback(g=>{!u&&g&&E("inspector"),k(g)},[k,E,u]),Ht=d.useCallback(g=>{S(g),E("inspector")},[E]);d.useEffect(()=>{f&&E("source")},[f,E]);const at=te(t,R),ft=ee(t,R),pt=ge(t),Xt=d.useMemo(()=>(t==null?void 0:t.actions.map(g=>g.attachments||[]).flat())||[],[t]),_=(t==null?void 0:t.sdkLanguage)||"javascript",At={id:"inspector",title:"Locator",render:()=>e.jsx(ae,{showScreenshot:$,sdkLanguage:_,setIsInspecting:xt,highlightedLocator:C,setHighlightedLocator:S})},Et={id:"call",title:"Call",render:()=>e.jsx(ue,{action:O,sdkLanguage:_})},Ft={id:"log",title:"Log",render:()=>e.jsx(fe,{action:O,isLive:r})},Dt={id:"errors",title:"Errors",errorCount:pt.errors.size,render:()=>e.jsx(ve,{errorsModel:pt,sdkLanguage:_,revealInSource:g=>{g.action?st(g.action):L(g),E("source")}})};let gt;!Q&&n&&(gt=(vt=n.source)==null?void 0:vt.errors.length);const rt={id:"source",title:"Source",errorCount:gt,render:()=>e.jsx(re,{stack:Rt,sources:Wt,rootDir:i,stackFrameLocation:A==="bottom"?"right":"bottom",fallbackLocation:n,onOpenExternally:o})},Pt={id:"console",title:"Console",count:at.entries.length,render:()=>e.jsx(se,{consoleModel:at,boundaries:ct,selectedTime:R,onAccepted:g=>U({minimum:g.timestamp,maximum:g.timestamp}),onEntryHovered:I})},Ut={id:"network",title:"Network",count:ft.resources.length,render:()=>e.jsx(ie,{boundaries:ct,networkModel:ft,onEntryHovered:y})},Bt={id:"attachments",title:"Attachments",count:Xt.length,render:()=>e.jsx(We,{model:t})},Y=[At,Et,Ft,Dt,Pt,Ut,rt,Bt];if(a!==void 0){const g={id:"annotations",title:"Annotations",count:a.length,render:()=>e.jsx(He,{annotations:a})};Y.push(g)}if(s){const g=Y.indexOf(rt);Y.splice(g,1),Y.splice(1,0,rt)}const{boundaries:ct}=d.useMemo(()=>{const g={minimum:(t==null?void 0:t.startTime)||0,maximum:(t==null?void 0:t.endTime)||3e4};return g.minimum>g.maximum&&(g.minimum=0,g.maximum=3e4),g.maximum+=(g.maximum-g.minimum)/20,{boundaries:g}},[t]);let Z=0;!r&&t&&t.endTime>=0?Z=t.endTime-t.startTime:t&&t.wallTime&&(Z=Date.now()-t.wallTime);const $t={id:"actions",title:"Actions",component:e.jsxs("div",{className:"vbox",children:[l&&e.jsxs("div",{className:"workbench-run-status",children:[e.jsx("span",{className:K("codicon",Xe(l))}),e.jsx("div",{children:Ae(l)}),e.jsx("div",{className:"spacer"}),e.jsx("div",{className:"workbench-run-duration",children:Z?D(Z):""})]}),e.jsx(de,{sdkLanguage:_,actions:(t==null?void 0:t.actions)||[],selectedAction:t?Q:void 0,selectedTime:R,setSelectedTime:U,onSelected:ut,onHighlighted:nt,revealConsole:()=>E("console"),isLive:r})]})},Ot={id:"metadata",title:"Metadata",component:e.jsx(Me,{model:t})};return e.jsxs("div",{className:"vbox workbench",...h?{inert:"true"}:{},children:[!c&&e.jsx(be,{model:t,consoleEntries:at.entries,boundaries:ct,highlightedAction:it,highlightedEntry:T,highlightedConsoleEntry:M,onSelected:ut,sdkLanguage:_,selectedTime:R,setSelectedTime:U}),e.jsx(wt,{sidebarSize:250,orientation:A==="bottom"?"vertical":"horizontal",settingName:"propertiesSidebar",main:e.jsx(wt,{sidebarSize:250,orientation:"horizontal",sidebarIsFirst:!0,settingName:"actionListSidebar",main:e.jsx(ne,{action:O,model:t,sdkLanguage:_,testIdAttributeName:(t==null?void 0:t.testIdAttributeName)||"data-testid",isInspecting:u,setIsInspecting:xt,highlightedLocator:C,setHighlightedLocator:Ht,openPage:m}),sidebar:e.jsx(Nt,{tabs:[$t,Ot],selectedTab:z,setSelectedTab:W})}),sidebar:e.jsx(Nt,{tabs:Y,selectedTab:P,setSelectedTab:E,rightToolbar:[A==="bottom"?e.jsx(bt,{title:"Dock to right",icon:"layout-sidebar-right-off",onClick:()=>{B("right")}}):e.jsx(bt,{title:"Dock to bottom",icon:"layout-panel-off",onClick:()=>{B("bottom")}})],mode:A==="bottom"?"default":"select"})})]})};export{Le as E,le as T,Fe as W,Xe as t};
